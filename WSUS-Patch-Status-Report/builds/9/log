Started by user [8mha:////4CaoB2Pf4pV37y0tI7Ug7cxmj6XmTZElVvK39GEAxNQEAAAAlx+LCAAAAAAAAP9b85aBtbiIQTGjNKU4P08vOT+vOD8nVc83PyU1x6OyILUoJzMv2y+/JJUBAhiZGBgqihhk0NSjKDWzXb3RdlLBUSYGJk8GtpzUvPSSDB8G5tKinBIGIZ+sxLJE/ZzEvHT94JKizLx0a6BxUmjGOUNodHsLgAzeEgZu/dLi1CL9xJTczDwACG0V4sAAAAA=[0mAdministrator
Running in Durability level: MAX_SURVIVABILITY
[8mha:////4OLV+lntHjZuxZp2t894VegAQzqSx7P3txzt/b9ofVCrAAAAoh+LCAAAAAAAAP9tjTEOwjAQBM8BClpKHuFItIiK1krDC0x8GCfWnbEdkooX8TX+gCESFVvtrLSa5wtWKcKBo5UdUu8otU4GP9jS5Mixv3geZcdn2TIl9igbHBs2eJyx4YwwR1SwULBGaj0nRzbDRnX6rmuvydanHMu2V1A5c4MHCFXMWcf8hSnC9jqYxPTz/BXAFEIGsfuclm8zQVqFvQAAAA==[0m[Pipeline] Start of Pipeline
[8mha:////4LwqxUFl6RELUlb7E1W5yt6jrbypcMQx5grSSCh7TyOtAAAApR+LCAAAAAAAAP9tjTEOwjAUQ3+KOrAycohUghExsUZZOEFIQkgb/d8mKe3EibgadyBQiQlLlmxL1nu+oE4RjhQdby12HpP2vA+jK4lPFLtroIm3dOGaMFGwXNpJkrGnpUrKFhaxClYC1hZ1oOTRZdiIVt1VExS65pxj2Q4CKm8GeAAThZxVzN8yR9jeRpMIf5y/AJj7DGxXvP/86jduZBmjwAAAAA==[0m[Pipeline] node
Running on [8mha:////4KZhxD3tv46iVbhKjbbb27qqykto+K3ZMv6IMwic71ghAAAAnh+LCAAAAAAAAP9b85aBtbiIQTGjNKU4P08vOT+vOD8nVc83PyU1x6OyILUoJzMv2y+/JJUBAhiZGBgqihhk0NSjKDWzXb3RdlLBUSYGJk8GtpzUvPSSDB8G5tKinBIGIZ+sxLJE/ZzEvHT94JKizLx0a6BxUmjGOUNodHsLgAz2EgZh/eT83ILSktQifY3cxGIgrakPAHib2iPIAAAA[0mJenkins in /var/lib/jenkins/workspace/WSUS-Patch-Status-Report
[8mha:////4C58DzLyD46MV1Rd5WJBaVz+E45TYGgZ+5XahqCj2HSlAAAApR+LCAAAAAAAAP9tjTEOwjAUQ3+KOrAycoh0gA0xsUZZOEFIQkgb/d8mKe3EibgadyBQiQlLlmxL1nu+oE4RjhQdby12HpP2vA+jK4lPFLtroIm3dOGaMFGwXNpJkrGnpUrKFhaxClYC1hZ1oOTRZdiIVt1VExS65pxj2Q4CKm8GeAAThZxVzN8yR9jeRpMIf5y/AJj7DGxXvP/86jfoP95RwAAAAA==[0m[Pipeline] {
[8mha:////4ERG3xrkOFexMT8+1J1pSGvle3kanr7bQDBu0KwPof1+AAAApR+LCAAAAAAAAP9tjTEOwjAUQ3+KOrAycoh0gQkxsUZZOEFIQkgb/d8mKe3EibgadyBQiQlLlmxL1nu+oE4RjhQdby12HpP2vA+jK4lPFLtroIm3dOGaMFGwXNpJkrGnpUrKFhaxClYC1hZ1oOTRZdiIVt1VExS65pxj2Q4CKm8GeAAThZxVzN8yR9jeRpMIf5y/AJj7DGxXvP/86jc09154wAAAAA==[0m[Pipeline] withCredentials
Masking supported pattern matches of $ansible_userid or $ansible_password
[8mha:////4K/ArAjwl9QOpmzlHW5Wms1meZ02ASF9sbPibfSBc2/+AAAApR+LCAAAAAAAAP9tjTEOwjAUQ3+KOrAycoh0ggUxsUZZOEFIQkgb/d8mKe3EibgadyBQiQlLlmxL1nu+oE4RjhQdby12HpP2vA+jK4lPFLtroIm3dOGaMFGwXNpJkrGnpUrKFhaxClYC1hZ1oOTRZdiIVt1VExS65pxj2Q4CKm8GeAAThZxVzN8yR9jeRpMIf5y/AJj7DGxXvP/86jek7ggRwAAAAA==[0m[Pipeline] {
[8mha:////4DIfZIsmi6f3oFGTFqGJySagjQVBFHrlavQDOyIXObFCAAAApR+LCAAAAAAAAP9tjTEOwjAUQ3+KOrAycoh0gwExsUZZOEFIQkgb/d8mKe3EibgadyBQiQlLlmxL1nu+oE4RjhQdby12HpP2vA+jK4lPFLtroIm3dOGaMFGwXNpJkrGnpUrKFhaxClYC1hZ1oOTRZdiIVt1VExS65pxj2Q4CKm8GeAAThZxVzN8yR9jeRpMIf5y/AJj7DGxXvP/86jcChmMxwAAAAA==[0m[Pipeline] stage
[8mha:////4FJSxUXCqmMjPbAn2Otf6s68g0+loEa2vUXL2jnVMecTAAAApR+LCAAAAAAAAP9tjTEOwjAUQ3+KOrAycoh0BAkxsUZZOEFIQkgb/d8mKe3EibgadyBQiQlLlmxL1nu+oE4RjhQdby12HpP2vA+jK4lPFLtroIm3dOGaMFGwXNpJkrGnpUrKFhaxClYC1hZ1oOTRZdiIVt1VExS65pxj2Q4CKm8GeAAThZxVzN8yR9jeRpMIf5y/AJj7DGxXvP/86jfpX/cvwAAAAA==[0m[Pipeline] { (Code Quality)
[8mha:////4JGKmfdW0JyHo2FM/61AzdI3x1ILbL+aa+jYfsZVPLQLAAAApR+LCAAAAAAAAP9tjTEOwjAUQ3+KOrAycoh0BSEm1igLJwhJCGmj/9skpZ04EVfjDgQqMWHJkm3Jes8X1CnCkaLjrcXOY9Ke92F0JfGJYncNNPGWLlwTJgqWSztJMva0VEnZwiJWwUrA2qIOlDy6DBvRqrtqgkLXnHMs20FA5c0AD2CikLOK+VvmCNvbaBLhj/MXAHOfge2K959f/QbB16AVwAAAAA==[0m[Pipeline] dir
Running in /var/lib/jenkins/workspace/WSUSPatch-Status-Report
[8mha:////4DpauG9ftNgMx4ocCjRmGYGv++vOlTn0ZTqjI0rJX0vRAAAAph+LCAAAAAAAAP9tjTEOwjAQBM9BKWgpeYQDJUJUtJYbXmBiY5xYd8G+kFS8iK/xBwKRqNhqZ6XVPF9Q5gQHSl42DtuAuQ6yi72fmhwotZdIg2zoLGvCTNFJ7QZN1h1n1MQO5ogCFgqWDutIOaBnWKnG3E0VDfrqxGna9gqKYG/wAKEmM5vEXxgTrK+9zYQ/z18BjB2D2DEU283nWL4Bsam+msEAAAA=[0m[Pipeline] {
[8mha:////4AZuGQabZLclvDSc7MlJTuJHmYaTBQ6+hWiqZ1iw8ZpnAAAAox+LCAAAAAAAAP9tjTEOwjAQBC9BFLSUPOJCakRFa6XhBSYxxo5159gOTsWL+Bp/IBCJii1WO9vM8wXrGODIQaNV1BuKrUHvRj0vzBz6q+OMli/YMkV2ChuVG+7UacGGk4IlRQkrARtFreNoSCfYCivvsnKSdHVOYf4OAkrTDfCAQszmJEP6whRgdxu7yPTz/BXA5BOU9f5TtX8D0loxuL4AAAA=[0m[Pipeline] sh
+ sh server_add.sh
[8mha:////4AyvExha2DAauUM+pMpI1SzGBwi2ZMbTxKQyqwJ4ZpoZAAAAox+LCAAAAAAAAP9tjTEOwjAQBC9BFLSUPOICtIgqreWGF5jYGCfWnbEdkooX8TX+QCASFVusdraZ5wuWKcKRo8XWUOcoNQ6D7+20cODYXTwP2PIZG6bE3qA0g2Rt6hklZwNzihIWAlaGGs/Jkc2wFq26q8orstUpx+k7CCidvsEDCjGZs4r5C2OEzbXXienn+SuAMYQM5W7/qe0bsgYiW74AAAA=[0m[Pipeline] }
[8mha:////4DFkW2ynJGArESzUbQGKwaPPXpRBZAJ/VPBSu3Fkjfr8AAAAox+LCAAAAAAAAP9tjTEOwjAQBDdBFLSUPMIRokKIitZKwwtMYowT6y7YF5KKF/E1/kBEJCq22plmXm8sU8SRo1ONpdZTqrzqQu+mpwaO7TXwoBq+qIopcbCqtEPJtT3NWLJYzMtyLDRWlqrAyZMTrHVjHqYIhlxxlji5g0bu6zueyPRUFhPlC2PE5tbXienX+RvA2HWCfLsTZPsP6C1U670AAAA=[0m[Pipeline] // dir
[8mha:////4CZnXPToyqMR4ivDOjVGmKLa0+/8bPaq2HTxncne2QvFAAAApB+LCAAAAAAAAP9tjTEOwjAQBDdBFLSUPMIREgUSoqK10vACkxjjxLoL9oWk4kV8jT8QEYmKrXammdcbyxRx5OhUY6n1lCqvutC76amBY3sNPKiGL6piShysKu1Qcm1PM5YsFvOyHAuNlaUqcPLkBGvdmIcpgiFXnCVO7qCR+/qOJzI9lcVE+cIYsbn1dWL6df4GMHadIN/uBNn+A27Bcy69AAAA[0m[Pipeline] }
[8mha:////4PoxC7DaPhq1iDWvS3Q16dYpcbY8He2mjq40OLMig7rcAAAApB+LCAAAAAAAAP9tjTEOwjAQBDdBFLSUPMIRBaJAVLRWGl5gEmOcWHfBvpBUvIiv8QciIlGx1c4083pjmSKOHJ1qLLWeUuVVF3o3PTVwbK+BB9XwRVVMiYNVpR1Kru1pxpLFYl6WY6GxslQFTp6cYK0b8zBFMOSKs8TJHTRyX9/xRKanspgoXxgjNre+Tky/zt8Axq4T5NudINt/AE/1rIO9AAAA[0m[Pipeline] // stage
[8mha:////4GWVCKtmtgQyePUq08sqa3WZDWx2Uk4sMqolnoZuupdfAAAAph+LCAAAAAAAAP9tjTEOwjAQBM9BKWgpeYQjmjSIitZywwtMYowT6y7YF5KKF/E1/oAhEhVb7ay0mucLyhThQNHJzmLvMTVeDmF0ucmJYn8JNMmOzrIhTBSs1HbS1NrjgprYwhJRwErB2mITKHl0DBvVmbupgkFXnTjmba+g8O0NHiBUNrOJ/IU5wvY6tonw5/krgHlgEDVDsas/x/INar4f38EAAAA=[0m[Pipeline] stage
[8mha:////4JomicfLJqc6Unbw2BQMJ9n2FcUuPUKaa/v+2ICQY/JBAAAApx+LCAAAAAAAAP9tjTEOwjAUQ3+LOrAycohULDAgpq5RFk4QmhDSRv+Xn5R24kRcjTvQUokJD5ZtyXqvNxSR4UTsRGOx9RhrL7rQuymJgbi9BhpEQxdRE0YKVig7KDK2WqqiZGFRlsNKwtpiHSh6dAk2stEPXQaNrjwnnrajhNybOzwhkxM5aU7fMjJsb72JhD/OXwCMXYJ8t5/tMD+LD1+IXOLCAAAA[0m[Pipeline] { (Code Copying)
[8mha:////4Ab4uFnX6yZp/mCZJOw1mH71icf/FLFc2/XsmLidarOPAAAApx+LCAAAAAAAAP9tjTEOwjAUQ3+LOrAycohUTCAhpq5RFk4QmhDSRv+Xn5R24kRcjTvQUokJD5ZtyXqvNxSR4UTsRGOx9RhrL7rQuymJgbi9BhpEQxdRE0YKVig7KDK2WqqiZGFRlsNKwtpiHSh6dAk2stEPXQaNrjwnnrajhNybOzwhkxM5aU7fMjJsb72JhD/OXwCMXYJ8t5/tMD+LD0rlhNLCAAAA[0m[Pipeline] dir
Running in /var/lib/jenkins/workspace/WSUSPatch-Status-Report
[8mha:////4H3FEPw0Yt2gsT/iJPY3depRcthUplHrUaR8ZJ6QJnvAAAAApx+LCAAAAAAAAP9tjTEOwjAUQ3+LOrAycohUbCDE1DXKwglCE0La6P/yk9JOnIircQdaKjHhwbItWe/1hiIynIidaCy2HmPtRRd6NyUxELfXQINo6CJqwkjBCmUHRcZWS1WULCzKclhJWFusA0WPLsFGNvqhy6DRlefE03aUkHtzhydkciInzelbRobtrTeR8Mf5C4CxS5Dv9rMd5mfxASnCIIrCAAAA[0m[Pipeline] {
[8mha:////4Mo4kCluwNb/Qeq9xgwYa3IDpr1HLyWtzOSIw+7pLQCmAAAApB+LCAAAAAAAAP9tjTEOwjAQBC9BFLSUPOICdAilorXc8AKTGOPEugu2g1PxIr7GH7CIRMUWq51t5vWGZfBQszfYaeothcbi4EaTFyb2/dVxwo4v2DAFdhqlTpJbfZpRctQwpyhhIWClqXEcLJkIa9Gph6qcIlOdo8/fUUBp2zs8oRDZHJWPX5g8bG5jG5h+nr8CmIYI5e6Qa78dPhmQ9Da+AAAA[0m[Pipeline] sh
+ ansible-playbook main.yml -i inventory.txt --tags=copy -e 'ansible_user=**** ansible_password=****'

PLAY [WSUS Patch Status Report] ************************************************

TASK [patchStatus : Create dir for copying files] ******************************
ok: [10.117.224.23]

PLAY RECAP *********************************************************************
10.117.224.23              : ok=1    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

[8mha:////4GzRX/R63u0o4srw30S0oLzLb3WALDRuw0Fp/sp0EtYXAAAApB+LCAAAAAAAAP9tjTEOwjAQBC9BFLSUPOKi0CFEldZKwwtMbIwT687YDknFi/gaf8AiEhVbrHa2mdcb1jHAiYPBXtNgKXYWvRtNXjhxGK6OJ+z5gh1TZKex1VPLSjcLtpw0LClKWAnYaOocR0smwVb08iErJ8lU5xTydxRQWnWHJxQim5MM6QtzgN1tVJHp5/krgNn7BOW+zlUfPiXWgpW+AAAA[0m[Pipeline] }
[8mha:////4NRLbkWXkVg+uCiXU9yaVG0Xssjy/IXo7xwvdONoUjaFAAAApR+LCAAAAAAAAP9tjTEOwjAQBC9BFLSUPMIRqZAQVVorDS8w8WGcWHfGdkgqXsTX+AMWkajYYrWzzbzesI4BThyM6JEGS7GzwrvR5CUmDsPV8SR6voiOKbJD0eLUssZmwZYTwpKihJWEDVLnOFoyCbayVw9VOUWmOqeQv6OE0uo7PKGQ2ZxUSF+YA+xuo45MP89fAczeJyjrOtf+8AEdlBFkvgAAAA==[0m[Pipeline] // dir
[8mha:////4L0M//zqxPrJLbC5uyQ1jMnGa1PlpuO4qquTe5gPOZdqAAAApR+LCAAAAAAAAP9tjTEOwjAQBC9BFLSUPOIioKBAqWgtN7zAJMY4se6C7eBUvIiv8QcsIlGxxWpnm3m9YRk81OwNdpp6S6GxOLjR5IWJfX91nLDjCzZMgZ1GqZPkVp9mlBw1zClKWAhYaWocB0smwlp06qEqp8hU5+jzdxRQ2vYOTyhENkfl4xcmD5vb2Aamn+evAKZhiFDu9rm2hw8pWvI/vgAAAA==[0m[Pipeline] }
[8mha:////4Dzzes2XQXllWajjvnDDmCX6xQ5F4wEaYMVAvd0ALzLAAAAApR+LCAAAAAAAAP9tjTEOwjAQBC9BFLSUPOIiEKJBqWgtN7zAJMY4se6C7eBUvIiv8QcsIlGxxWpnm3m9YRk81OwNdpp6S6GxOLjR5IWJfX91nLDjCzZMgZ1GqZPkVp9mlBw1zClKWAhYaWocB0smwlp06qEqp8hU5+jzdxRQ2vYOTyhENkfl4xcmD5vb2Aamn+evAKZhiFDu9rm2hw8HWvBVvgAAAA==[0m[Pipeline] // stage
[8mha:////4NmvwAUvAF0wC5xZztHJ1WYEGJ+Qd/vgq7G9DU/X8RGsAAAApx+LCAAAAAAAAP9tjTEOwjAQBM9BKWgpeYQjIUGDqGgtN7zAxMY4se6CfSGpeBFf4w8EIlGx1c5Kq3m+oMwJDpS8bBy2AXMdZBd7PzU5UGovkQbZ0FnWhJmik9oNmqw7zqiJHcwRBSwULB3WkXJAz7BSjbmbKhr01YnTtO0VFMHe4AFCTWY2ib8wJlhfe5sJf56/Ahg7BrFjKDbbz7F8A1nWY2jBAAAA[0m[Pipeline] stage
[8mha:////4EnJTP0IGQPXEoaJibClIXhe4Q10JL9MGlQdJMcxSJ9AAAAAqB+LCAAAAAAAAP9tjTEOwjAUQ3+LOrAycohUQoIFMXWNsnCC0ISQNvq//KS0EyfiatyBlkpMeLBsS9Z7vaGIDCdiJxqLrcdYe9GF3k1JDMTtNdAgGrqImjBSsELZQZGx1VIVJQuLshxWEtYW60DRo0uwkY1+6DJodOU58bQdJeTe3OEJmZzISXP6lpFhe+tNJPxx/gJg7BLku/1sh/lZfACW9ZT2wgAAAA==[0m[Pipeline] { (Generate Report)
[8mha:////4Bs8J7gn6dMS4Xui61RS/4ME6WxL+Wuml1G2rXJvhG4uAAAAqB+LCAAAAAAAAP9tjTEOwjAUQ3+LOrAycohUYoABMXWNsnCC0ISQNvq//KS0EyfiatyBlkpMeLBsS9Z7vaGIDCdiJxqLrcdYe9GF3k1JDMTtNdAgGrqImjBSsELZQZGx1VIVJQuLshxWEtYW60DRo0uwkY1+6DJodOU58bQdJeTe3OEJmZzISXP6lpFhe+tNJPxx/gJg7BLku/1sh/lZfAAyQCqkwgAAAA==[0m[Pipeline] dir
Running in /var/lib/jenkins/workspace/WSUSPatch-Status-Report
[8mha:////4OX6ri0TFG7Yni2xNoXG+IkD/L4PWowiQD0lv1dnLqelAAAAqB+LCAAAAAAAAP9tjTEOwjAUQ3+LOrAycohUYgEJMXWNsnCC0ISQNvq//KS0EyfiatyBlkpMeLBsS9Z7vaGIDCdiJxqLrcdYe9GF3k1JDMTtNdAgGrqImjBSsELZQZGx1VIVJQuLshxWEtYW60DRo0uwkY1+6DJodOU58bQdJeTe3OEJmZzISXP6lpFhe+tNJPxx/gJg7BLku/1sh/lZfAAnLfKUwgAAAA==[0m[Pipeline] {
[8mha:////4CgkpM2Jw66cYz7ohpRRO1W+N6QVyPORfAgBCdKOeP2jAAAApB+LCAAAAAAAAP9tjTEOwjAQBC9BFLSUPOIiUYEQVVrLDS8wsTFOrDtjOyQVL+Jr/IFAJCq2WO1sM88XLFOEI0eLraHOUWocBt/baeHAsbt4HrDlMzZMib1BaQbJ2tQzSs4G5hQlLASsDDWekyObYS1adVeVV2SrU47TdxBQOn2DBxRiMmcV8xfGCJtrrxPTz/NXAGPIUG53n9qHNwcnzs++AAAA[0m[Pipeline] sh
+ ansible-playbook main.yml -i inventory.txt --tags=create -e 'ansible_user=**** ansible_password=****'

PLAY [WSUS Patch Status Report] ************************************************

TASK [patchStatus : Generating Report] *****************************************
fatal: [10.117.224.23]: FAILED! => {"changed": true, "cmd": "$Oreport=\"C:\\tmp\\WSUSPatchStatusReport\\Patchsummary.htm\"\n$Ofile =\"C:\tmp\\WSUSPatchStatusReport\\WSUSdata.csv\"\nIf ((Test-Path $Ofile) -eq $true){ Remove-Item $Ofile }\n[void][reflection.assembly]::LoadWithPartialName(\"Microsoft.UpdateServices.Administration\")\n$wsus = [Microsoft.UpdateServices.Administration.AdminProxy]::getUpdateServer($(hostname),$False,8530)\n$Compscope = new-object Microsoft.UpdateServices.Administration.ComputerTargetScope\n$updateScope = new-object Microsoft.UpdateServices.Administration.UpdateScope;\n$updateScope.UpdateApprovalActions = [Microsoft.UpdateServices.Administration.UpdateApprovalActions]::Install\n$gpnames=$wsus.GetComputerTargetGroups()\n$updates = $wsus.GetUpdates()\nforeach($update in $updates){\nif ($update.state -ne \"NotNeeded\") {\n$out=$Null\n$update.GetUpdateInstallationInfoPerComputerTarget($Compscope) | ?{$_.UpdateInstallationState -ne \"NotApplicable\"} | % {\n$Comp = $wsus.GetComputerTarget($_.ComputerTargetId)\n$gpn=$gps=$null\nforeach ($grpnmid in $($Comp.ComputerTargetGroupIds.guid)) {\n$gps=($gpnames | ? {$_.id -eq $grpnmid -and $_.name -notmatch \"All\"}).name\nIf ($gps) {$gpn += \"$gps\" }\n}\n$info = \"\" | select KBnumber, Computername, Groupname, OS, IpAddress, UpdateInstallationStatus, UpdateTitle, Creation, Year,state\n$info.UpdateTitle = $update.Title\n$info.KBnumber = \"KB\"+$Update.KnowledgebaseArticles\n$info.Computername = $Comp.FullDomainName\n$info.Groupname = $gpn\n$info.OS = $Comp.OSDescription\n$info.IpAddress = $Comp.IPAddress\n$info.Creation = $CreationDate\n$info.year = get-date $CreationDate -f yyyy\n$info.UpdateInstallationStatus = $_.UpdateInstallationState\n$info.state = $update.state\n$info |  Export-Csv -Path $Ofile -Append -NoTypeInformation\n}\n}\n}\n$datas=Import-Csv $Ofile\n$kbs= ($datas | Select-Object KBnumber  -unique ).KBnumber\n$servers=($datas | Select-Object Computername  -unique).Computername\n$Regions=($datas | Select-Object groupname -unique).groupname\n$Mval=@(0,0,0,0,0,0,0,0)\n$MRegdata=$null\n$val=0; while($val -lt $Regions.count)  {\n$Refdata=$null\nif ($Regions.count -eq \"1\") {$Refdata=$Regions} else {$Refdata=$Regions[$val] }\n$svr=$null\n$svr=($datas | where-object {($_.groupname -eq  $Refdata) -and ($_.UpdateInstallationStatus -eq \"Installed\")}).Computername\n$Totsrvs=$svr.count\nif ($svr) {\n$Mval[$val]=$svr.count\n$MRegdata+=\"<TD>$($Mval[$val])</TD>\"\n}\n$val++\n}\n$MMisval=@(0,0,0,0,0,0,0,0)\n$MisRegdata=$null\n$Refdata=$null\n$ToMisscount=0\n$svrs=$null\n$svrs=($datas | where-object {($_.UpdateInstallationStatus -eq \"NotInstalled\")}).Computername\n$ToMisscount=$svrs.count\n$val=0; while($val -lt $Regions.count)  {\nif ($Regions.count -eq \"1\") {$Refdata=$Regions} else {$Refdata=$Regions[$val] }\n$svr=$null\n$svr=($datas | where-object {($_.groupname -eq  $Refdata) -and ($_.UpdateInstallationStatus -eq \"NotInstalled\")}).Computername\n$ToMisscount=$svr.count\nif ($svr) {\n$MMisval[$val]=$svr.count\n}\n$MisRegdata+=\"<TD>$($MMisval[$val])</TD>\"\n$val++\n}\n$val=0; while($val -lt $Regions.count)  {\n$Refdata=$null\nif ($Regions.count -eq \"1\") {$Refdata=$Regions} else {$Refdata=$Regions[$val] }\n$Reghd+=\"<th>$($Refdata)</th>\"\n$val++\n}\nif ($Totsrvs -ne  \"0\") {\n$Mpatchper1=$null\n$MTotsr=$ToMisscount + $Totsrvs\n$Mpatchper1 = (1- $Totsrvs/$MTotsr )*100\n$Mpatchper = [math]::Round($Mpatchper1,2)\n} else {\nif ($ToMisscount -ne  \"0\") { $Mpatchper=100} else { $Mpatchper=0}\n}\n$body = \"<table cellpadding=3 cellspacing=1  bgcolor=#FF8F2F style='font-family:verdana; font-size:7pt;'>\"\n$body += \"<tr bgcolor=white align=center><TH colspan=1 align=left></TH><TH colspan=$($Regions.count +1) align=left>Missed</TH><TH colspan=$($Regions.count +1) align=left>Installed</TH><TH colspan=1 align=left>Missing</TH></tr>\"\n$body += \"<tr bgcolor=#DDDDDD><th>KB Number</th>$Reghd<th>Total</th>$Reghd<th>Total</th><th>%age</th></tr>\"\n$body += \"<tr bgcolor=white align=center><TH>All</TH>$MisRegdata<TH>$ToMisscount</TH>$MRegdata<TH>$Totsrvs</TH><TH>$Mpatchper%</TH></tr>\"\nforeach ($kb in $kbs) {\n$compcount=0\n$Miscompcount=0\n$Regdata=$null\n$Regdata2=$null\n$Rval=@(0,0,0,0,0,0,0,0)\n$Misval=@(0,0,0,0,0,0,0,0)\nforeach ($server in $servers) {\nforeach ($data in $datas) {\n$out=$data | where-object {($_.kbnumber -match $kb) -and ($_.computername -match  $server )}\nIf ($out) {\n$val=0 ; while($val -lt $Regions.count)  {\nif ($out.UpdateInstallationStatus -eq \"Installed\"){\n$Refdata=$null\nif ($Regions.count -eq \"1\") {$Refdata=$Regions} else {$Refdata=$Regions[$val] }\nif ($Refdata -eq $out.groupname) { $Rval[$val]+=1 ; $compcount++}\n}\nif ($out.UpdateInstallationStatus -eq \"NotInstalled\"){\n$Refdata=$null\nif ($Regions.count -eq \"1\") {$Refdata=$Regions} else {$Refdata=$Regions[$val] }\nif ($Refdata -eq $out.groupname) { $Misval[$val]+=1 ; $Miscompcount++}\n}\n$val++\n}\n$Rval\n\"---\"\n}\n}\n}\nif ($compcount -ne  \"0\") {\n$patchper1=$null\n$Totsr=$compcount + $Miscompcount\n$patchper1 = (1- $compcount/$Totsr )*100\n$patchper = [math]::Round($patchper1,2)\n} else {\n$val=0; while($val -lt $Regions.count){\n$Regdata+=\"<TD>$($Rval[$val])</TD>\"\n$Regdata2+=\"<TD>$($misval[$val])</TD>\"\n$val++\n}\n$body += \"<tr bgcolor=white align=center><TD>$kb</TD>\",\"$Regdata2<TD>$Miscompcount</TD>$Regdata<TD>$compcount</TD>\",\"<TD>$patchper%</TD></tr>\"\nWrite-host \"$kb -$Totsrvs - $compcount -$patchper%\"\n}\n$body += \"</Table>\"\n$msgBody = \"<table  cellpadding=3 cellspacing=1  bgcolor=#FF8F2F>\"\n$msgBody += \"<tr>\"\n$msgBody += \"<td bgcolor=#DDDDDD><FONT face=Verdana size=1.5 ><center><b>WSUS KB Report</b></center></font></td>\"\n$msgBody += \"</tr>\"\n$msgBody += \"<tr>\"\n$msgBody += \"<td bgcolor=white><FONT face=Verdana size=1.5 >$body</font></td>\"\n$msgBody += \"</tr>\"\n$msgBody += \"</table>\"\nIf ((Test-Path $Oreport) -eq $true){ Remove-Item $Oreport }\n$msgBody >$Oreport", "delta": "0:00:00.499993", "end": "2019-11-20 12:09:39.076562", "msg": "non-zero return code", "rc": 1, "start": "2019-11-20 12:09:38.576569", "stderr": "Missing closing '}' in statement block or type definition.\r\n    + CategoryInfo          : ParserError: (:) [], ParentContainsErrorRecordException\r\n    + FullyQualifiedErrorId : MissingEndCurlyBrace", "stderr_lines": ["Missing closing '}' in statement block or type definition.", "    + CategoryInfo          : ParserError: (:) [], ParentContainsErrorRecordException", "    + FullyQualifiedErrorId : MissingEndCurlyBrace"], "stdout": "", "stdout_lines": []}

PLAY RECAP *********************************************************************
10.117.224.23              : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   

[8mha:////4CLU3GKqVfJ+rsbY7WSNNjoDrPlxlVO0Wvoc7waSrs7SAAAApR+LCAAAAAAAAP9tjTEOwjAQBC9BFLSUPOKCoEFCqWgtN7zAJMY4se6C7eBUvIiv8QcsIlGxxWpnm3m9YRk81OwNdpp6S6GxOLjR5IWJfX91nLDjCzZMgZ1GqZPkVp9mlBw1zClKWAhYaWocB0smwlp06qEqp8hU5+jzdxRQ2vYOTyhENkfl4xcmD5vb2Aamn+evAKZhiFDut7l2hw9hbYOkvgAAAA==[0m[Pipeline] }
[8mha:////4MwM9zhsL+FhRmxocTKfDFXSMKxMzmLOYingrrQzxwkOAAAApR+LCAAAAAAAAP9tjTEOwjAQBC9BFLSUPOIioKBAqWgtN7zAJMY4se6C7eBUvIiv8QcsIlGxxWpnm3m9YRk81OwNdpp6S6GxOLjR5IWJfX91nLDjCzZMgZ1GqZPkVp9mlBw1zClKWAhYaWocB0smwlp06qEqp8hU5+jzdxRQ2vYOTyhENkfl4xcmD5vb2Aamn+evAKZhiFDut7l2hw9Vo2D/vgAAAA==[0m[Pipeline] // dir
[8mha:////4OPMyfao33h8HvqLWIkI2PaOLlBd5l+xUlvZlIRt8/7FAAAApR+LCAAAAAAAAP9tjTEOwjAQBC9BFLSUPOIiBYkGUaW10vACExvjxLoztkNS8SK+xh+wiETFFqudbeb1hnUMcOJgsNc0WIqdRe9GkxdOHIar4wl7vmDHFNlpbPXUstLNgi0nDUuKElYCNpo6x9GSSbAVvXzIykky1TmF/B0FlFbd4QmFyOYkQ/rCHGB3G1Vk+nn+CmD2PkG5r3PVhw9t4fMOvgAAAA==[0m[Pipeline] }
[8mha:////4NItnbBduM+RBTM8xSclLLc49lOFkq12jQsaVbtM4zNiAAAApR+LCAAAAAAAAP9tjTEOwjAQBC9BFLSUPMKRiKgQVVorDS8w8WGcWHfGdkgqXsTX+AMWkajYYrWzzbzesI4BThyM6JEGS7GzwrvR5CUmDsPV8SR6voiOKbJD0eLUssZmwZYTwpKihJWEDVLnOFoyCbayVw9VOUWmOqeQv6OE0uo7PKGQ2ZxUSF+YA+xuo45MP89fAczeJyjrOtf+8AFyY6ZcvgAAAA==[0m[Pipeline] // stage
[8mha:////4M8wtQ3kQxsdCG62yHOYM1xQMULklgZhjyGZ4IDpByyuAAAAox+LCAAAAAAAAP9tjTEOwjAQBDdBFLSUPMIpQDSIitZKwwtMYowT6y7YF5KKF/E1/kBEJCq22plmXm8sU8SRo1ONpdZTqrzqQu+mpwaO7TXwoBq+qIopcbCqtEPJtT3NWLJYzMtyLDRWlqrAyZMTrHVjHqYIhlxxlji5g0bu6zueyPRUFhPlC2PE5tbXienX+RvA2HWCfLsTZPsPYk0DhL0AAAA=[0m[Pipeline] }
[8mha:////4A7eHkFQ9upB4WhkTki5RuBigkyhtygnnYnaJ4iWpwsaAAAAox+LCAAAAAAAAP9tjTESgjAQRT84FraWHiIUDpVjZZuh8QQRYgxkdjFZhMoTeTXvICMzVv7qv9e81xvrFHHk6FRrqfOUaq/6MLj5qZFjdw08qpYvqmZKHKyq7FhxY08LViwWy7IcK42NpTpw8uQEW92ahymCIVecJc7uoJH75o4nMj2XxUT5whSxuw1NYvp1/gYw9b0g35eCrPwAaDVqIL0AAAA=[0m[Pipeline] // withCredentials
[8mha:////4NsN6Qqs9IF0bwxA+yxTQVhPH52k9ZV7SdpoIQesBiX/AAAAox+LCAAAAAAAAP9tjTEOwjAQBDdBFLSUPMIpQDSIitZKwwtMYowT6y7YF5KKF/E1/kBEJCq22plmXm8sU8SRo1ONpdZTqrzqQu+mpwaO7TXwoBq+qIopcbCqtEPJtT3NWLJYzMtyLDRWlqrAyZMTrHVjHqYIhlxxlji5g0bu6zueyPRUFhPlC2PE5tbXienX+RvA2HWCfLsXZLsPLn/NEL0AAAA=[0m[Pipeline] }
[8mha:////4BiR5HfIExJ/h1Y58IrS5bJUxNpmEOgOf0NQuGD7GjIMAAAAox+LCAAAAAAAAP9tjTESgjAQRT84FraWHiIUFBaOlW2GxhNEiDGQ2cVkESpP5NW8g4zMWPmr/17zXm+sU8SRo1Otpc5Tqr3qw+Dmp0aO3TXwqFq+qJopcbCqsmPFjT0tWLFYLMtyrDQ2lurAyZMTbHVrHqYIhlxxlji7g0bumzueyPRcFhPlC1PE7jY0ienX+RvA1PeCvNwLsvIDPcPJs70AAAA=[0m[Pipeline] // node
[8mha:////4OOPUVWiXhAgWl7qig2nRLSFmS3U0avEXtUzIEJ0yVnSAAAApB+LCAAAAAAAAP9tjTEOwjAQBDdBFLSUPMKRoEFCVLRWGl5gEmOcWHfBvpBUvIiv8QciIlGx1c4083pjmSKOHJ1qLLWeUuVVF3o3PTVwbK+BB9XwRVVMiYNVpR1Kru1pxpLFYl6WY6GxslQFTp6cYK0b8zBFMOSKs8TJHTRyX9/xRKanspgoXxgjNre+Tky/zt8Axq4T5Lu9INt+AHpknka9AAAA[0m[Pipeline] End of Pipeline
ERROR: script returned exit code 2
Finished: FAILURE
